---
layout: post
title: "Python 教程第一季"
date: 2019-12-10
tags: [提高姿势水平,工具]
comments: true
share: true
---

> 为实现喜瑞斯的伟大复兴而奋斗终生。

[![996.icu](https://img.shields.io/badge/link-996.icu-red.svg)](https://996.icu) [![LICENSE](https://img.shields.io/badge/license-Anti%20996-blue.svg)](https://github.com/996icu/996.ICU/blob/master/LICENSE) ![fuck-Scdiler](https://img.shields.io/badge/fuck-Scdiler-FD9827) ![sponsors-FUCengers](https://img.shields.io/badge/sponsors-FUCengers-brightgreen.svg)

我是想拿 Python 撸点儿题, 以后还想学点儿 NLP. 为此得先系统看下 Python. 作为一个从数院出来的人, 数学基础还是有点儿的, 这个到时候碰到的话再说. 先不考虑那么远, 把 Python 搞定是第一位的.

参考了廖雪峰老师的 [Python 教程](https://www.liaoxuefeng.com/wiki/1016959663602400). [稚年SaRo](https://weibo.com/sarosang) 这只 DotA 2 / CS: Go 主播小姐姐曾经看过这个教程: ![背书.png](https://i.loli.net/2019/12/02/6EzdftFawGeUxkL.png) 她以前在斗鱼上直播过写代码, 只是当时我不怎么看直播也没办牌子. 现在我倒是有她的直播间牌子, 对看她背 GRE 和刷模拟题比较有兴趣, 对打游戏的兴趣倒一般(我是 DotA / CS 1.5 / CS 1.6 这种古董骨灰化石玩家). 我有幸和她还有直播间水友约过三国杀 OL 身份局, 不过她四连跪, 截止到我做完这个笔记之前我认为她应该是不会再开身份局了(那四盘她那边儿总是碰到坑比, 而我混了两盘反贼躺赢)😂 SaRo 的斗鱼直播间地如下: [傻肉的直播间地址](https://www.douyu.com/469012), 有兴趣的旁友可以送飞机给火箭刷超火.

然后就正式进入到 Python 环节了. 出于篇幅和时间上的考量, 我不会完全复刻廖雪峰老师的教程, 也没必要. 因此会省略无关紧要或是我已了解的章节. 不过碰到常识性的东西或者有意思的东西还是会写一笔的.

## 0. Python 简介

在 [Python 官网 - https://www.python.org](https://www.python.org) 没有翻到大事记一类的东西, 只好拿廖雪峰老师教程的这句来代替了:

> Python 是 Guido van Rossum 在 1989 年圣诞节期间，为了打发无聊的圣诞节而编写的一个编程语言。

感谢 Guido van Rossum 老师为反对 996 工作制而发声:

[![Qno4FH.png](https://s2.ax1x.com/2019/12/02/Qno4FH.png)](https://twitter.com/gvanrossum/status/1111628076801236993)

## 1. 安装 Python

Python 有 2.x 版本和 3.x 版本, 2.x 版本已经凉了, 而 3.x 版本就像是 PHP 7.x 版本一样, 会是未来的趋势, 这就是我们用 Python 3 的理由. 安装也将以 3 为例.

操作系统是 macOS 10.15.1. 环境比较奇葩.

* 如果使用 Homebrew 安装 Python 3 的话, 有可能需要重新安装 Homebrew. Homebrew 的 GitHub 主页为 [Homebrew/brew](https://github.com/Homebrew/brew). 然后点到 Homebrew 的官网, 然后复制官网上的安装命令粘贴到命令行中回车, 等安装即可. 我之前的那个 Homebrew 貌似是崩了.
* 如果使用 Python 官网的 `.pkg` 安装包来进行安装的话, 一路安过去即可. 安完之后会弹出来一个 Finder 目录对象, 里面有将这个安装包对应安的 Python 写入环境变量的 `.command` 文件; 还有安个什么 license 的 `.command` 文件, 安的时候会有提示你升级 pip 的命令, 可以以此来升级之.

### 1.1 Python 解释器

Python 源文件为 `.py` 格式的文本文件. 需要使用 Python 解释器来执行 `.py` 文件.

主流的 Python 解释器有如下几种:

* CPython: 解释器使用 C 开发. 这个是比较主流的 Python 解释器.
* IPython: 基于 CPython 的一个 *交互式* 解释器.
* PyPy: 使用了 JIT 技术提高了 Python 代码的执行速度的 Python 解释器.
* Jython: 运行在 Java 平台上的 Python 解释器, 可以直接把 Python 代码编译成 Java 字节码执行.
* IronPython: 运行在 .NET 平台上的 Python 解释器, 可以直接把 Python 代码编译成 .NET 字节码.

## 2. 第一个 Python 程序

macOS 中已经预安装了 Python 2. 在 **macOS** 下的命令行终端中, 直接 `python` 会进入到 Python 2 的交互模式, 结果如下:

> Python 2.7.16 (v2.7.16:413a49145e, Mar  2 2019, 14:32:10)<br/>
[GCC 4.2.1 Compatible Apple LLVM 6.0 (clang-600.0.57)] on darwin<br/>
Type "help", "copyright", "credits" or "license" for more information.<br/>
\>\>\>

而在 macOS 下, 我们要使用 Python 3 的话, 应当输入 `python3`, 结果如下:

> Python 3.8.0 (v3.8.0:fa919fdf25, Oct 14 2019, 10:23:27)<br/>
[Clang 6.0 (clang-600.0.57)] on darwin<br/>
Type "help", "copyright", "credits" or "license" for more information.<br/>
\>\>\>

使用 `python3` 执行脚本的话, 需要先 `cd` 到脚本所在目录, 再 `python3 脚本名字.py`; 当然了, 你直接 `python3 脚本绝对路径` 也可以.

### 2.1 使用文本编辑器

挑个顺手的用就可以.

下面写一下如何直接执行 `.py` 文件.

`cd` 到一个目录, 在这个目录下新建一个 `.py` 文件, 举例来说, 名字就叫 `test.py` 吧, 而内容如下:

```python
#!/usr/bin/env python3

print('申帝, 我艹你妈!');
```

第一行的 `env` 是和环境变量相关的意思, 但是整句意思我不能完全解释, 只需知道它是配置环境的就行了.

然后我们需要为 `test.py` 加一个权限, 否则如果直接执行的话, 会报

> zsh: permission denied: ./test.py

加权限是 

```bash
chmod a+x test.py
```

加完权限以后, 你再 `./test.py`, 会输出:

> 申帝, 我艹你妈!

### 2.2 输入和输出

输出使用 [`print()`](https://docs.python.org/3.8/library/functions.html#print) 函数.

示例:

```py
>>> print('I love Faer 3000.')
```

结果: 

> I love Faer 3000.

[`print()`](https://docs.python.org/3.8/library/functions.html#print) 函数可以接收多个字符串作为参数. 看下文档, 可以知道默认的分隔符以单个空格 ` ` 作为参数.

示例:

```py
>>> print('结一个纪念的绳结', '记录你离去后', '万语和千言瓦解')
```

结果: 

> 结一个纪念的绳结 记录你离去后 万语和千言瓦解

输出可以使用 [`input()`](https://docs.python.org/3.8/library/functions.html#input) 函数，它可以让用户输入字符串，并存放到一个变量里。

示例：

```py
#!/usr/bin/env python3
name = input('Please type the name: ')
print(name, 'CJB.', sep = '')
```

> Please type the name: <strong>XR</strong><br/>
> XRCJB.

加粗字体部分为用户输入内容。这个分隔符的设置我是参考的 [Python \| sep parameter in print()](https://www.geeksforgeeks.org/python-sep-parameter-print/).

## 3. Python 基础

### 3.1 数据类型和变量

#### 3.1.1 数据类型

Python 能直接处理的数据类型包括：
* 整数:<br/>十六进制证书使用 `0x` 前缀和 0-9，a-f 表示.
* 浮点数:<br/>可以使用科学计数法表示，把 10 用 e 来替代。
* 字符串:<br/>字符串是以一对单引号 `'` 或双引号 `"` 括起来的任意文本。字符串内同时包含 `'` 和 `"` 时，需要使用 `\` 字符来转义。<br/>Python 允许使用 `r''` 来表示 `''` 内部的字符串默认不转义。<br/>如果字符串内部有很多换行，用 `\n` 写在一行里不好阅读，为了简化，Python允许用 `'''...'''` 的格式表示多行内容。<br/>多行字符串 `'''...'''` 还可以在前面加上 `r` 使用。
* 布尔值:<br/>一个布尔值只有 `True`、`False` 两种值，要么是 `True`，要么是 `False`，在 `Python` 中，可以直接用 `True`、`False` 表示布尔值（**请注意大小写**），也可以通过布尔运算计算出来。<br/>布尔值可以用 `and`、`or` 和 `not` 运算。
* 空值:<br/>空值是 Python 里一个特殊的值，用 `None` 表示。`None` 不能理解为 `0`，因为 `0` 是有意义的，而 `None` 是一个特殊的空值。

此外，Python 还提供了列表、字典、集合等多种数据类型，还允许创建自定义数据类型，我们后面会继续讲到。

示例：

```py
#!/usr/bin/env python3
print('''但愿你的眼睛\\\t只看得到笑容\\
但愿你流下每一滴泪\\\t都让人感动\\
但愿你以后每一个梦\\\t不会一场空\\''')
```

运行这段脚本，结果如下：

> 但愿你的眼睛\ &nbsp;&nbsp;&nbsp;&nbsp;只看得到笑容\ <br/>
> 但愿你流下每一滴泪\ &nbsp;&nbsp;&nbsp;&nbsp;都让人感动\ <br/>
> 但愿你以后每一个梦\ &nbsp;&nbsp;&nbsp;&nbsp;不会一场空\ <br/>

示例 2：

```py
#!/usr/bin/env python3
print(r'我不忍心再欺哄\\但愿你听得懂\\')
```

运行这段脚本，结果如下：

> 我不忍心再欺哄\\\\但愿你听得懂\\\\

#### 3.1.2 变量

变量名必须是大小写英文、数字和_的组合，且不能用数字开头。

在 Python 中，等号 `=` 是赋值语句，可以把任意数据类型赋值给变量，同一个变量可以反复赋值，而且可以是不同类型的变量。例如：

```py
#!/usr/bin/env python3
a = 67373 # a 是整数
print(a)
a = 'XRCJB.' # a 变为字符串
print(a)
```

运行这个脚本，结果是：

> 67373<br/>
> XRCJB.

这种变量本身类型不固定的语言称之为 *动态语言*，与之对应的是 *静态语言*。静态语言在定义变量时必须指定变量类型，如果赋值的时候类型不匹配，就会报错。

例如：JavaScript、PHP 就是动态语言；Objective-C、Swift、Java 就是静态语言。

当我们写

```py
a = 'ABC'
```

时，Python 解释器干了两件事情：

1. 在内存中创建了一个 `'ABC'` 的字符串；
2. 在内存中创建了一个名为 `a` 的变量，并把它指向 `'ABC'`。

思考：

```py
a = 'ABC'
b = a
a = 'XYZ'
print(b)
```

这个结果是多少？流程是什么样的？

#### 3.1.3 常量

所谓常量就是不能变的变量，比如常用的数学常数 π 就是一个常量。在 Python 中，通常用全部大写的变量名表示常量：

```py
PI = 3.14159265359
```

但事实上 `PI` 仍然是一个变量，Python 根本没有任何机制保证 `PI` 不会被改变，所以，用全部大写的变量名表示常量只是一个习惯上的用法，如果你一定要改变变量 `PI` 的值，也没人能拦住你。

最后解释一下整数的除法为什么也是精确的。在Python中，有两种除法，一种除法是 `/`：

```py
>>> 10 / 3
```

结果如下：

> 3.3333333333333335

`/` 除法计算结果是浮点数，即使是两个整数恰好整除，结果也是浮点数：

```py
>>> 9 / 3
```

结果如下：

> 3.0

还有一种除法是 `//`，称为地板除，两个整数的除法仍然是整数：

```py
>>> 10 // 3
```

结果如下：

> 3

你没有看错，整数的地板除 `//` 永远是整数，即使除不尽。要做精确的除法，使用 `/` 就可以。

因为 `//` 除法只取结果的整数部分，所以 Python 还提供一个余数运算，可以得到两个整数相除的余数：

```py
>>> 10 % 3
```

结果如下：

> 1

无论整数做 `//` 除法还是取余数，结果永远是整数，所以，整数运算结果永远是精确的。

注意：<br/>
Python 的整数没有大小限制。<br/>
Python 的浮点数也没有大小限制，但是超出一定范围就直接表示为 `inf`（无限大）。


### 3.2 字符串和编码

#### 3.2.1 字符编码

ASCII 编码：基础，能表示字符太少；<br/>
各国语言编码：各国标准容易发生冲突，导致有乱码显示；<br/>
Unicode 编码：把所有语言都统一到一套编码里，这样就不会再有乱码问题了。但在表示常用字符时存储空间偏大，存储和传输不划算。<br/>
UTF-8 编码：可变长编码。既能像 Unicode 编码那样能够表示生僻字符，又在表示常用字符时能节省空间。此外 ASCII 编码实际上可以被看成是 UTF-8 编码的一部分，所以，大量只支持 ASCII 编码的历史遗留软件可以在 UTF-8 编码下继续工作。

计算机系统通用的字符编码工作方式大概是像这样的：

在计算机内存中，统一使用 Unicode 编码，当需要保存到硬盘或者需要传输的时候，就转换为 UTF-8 编码。

用记事本编辑的时候，从文件读取的 UTF-8 字符被转换为 Unicode 字符到内存里，编辑完成后，保存的时候再把 Unicode 转换为 UTF-8 保存到文件。

浏览网页的时候，服务器会把动态生成的 Unicode 内容转换为 UTF-8 再传输到浏览器。

#### 3.2.2 Python 的字符串

最新的 Python 3 中，字符串是以 Unicode 编码的，也就是说，Python 的字符串支持多语言。

对于单个字符的编码，Python 提供了 [`ord()`](https://docs.python.org/3.8/library/functions.html#ord) 函数获取字符的整数表示，[`chr()`](https://docs.python.org/3.8/library/functions.html#chr) 函数把编码转换为对应的字符。

如果知道字符的整数编码，还可以用十六进制直接写字符串。

示例：

```py
#!/usr/bin/env python3
print(ord('傻'))
print(chr(32905))
print('\u6027\u611f\u50bb\u8089\u5728\u7ebf\u505a\u9898')
```

运行脚本结果如下：

> 20667<br/>
> 肉<br/>
> 性感傻肉在线做题

由于 Python 的字符串类型是 `str`，在内存中以 Unicode 表示，一个字符对应若干个字节。如果要在网络上传输，或者保存到磁盘上，就需要把 str 变为以字节为单位的 `bytes`。

Python 对 `bytes` 类型的数据用带 `b` 前缀的单引号或双引号表示。

要注意区分 `'ABC'` 和 `b'ABC'`，前者是 `str`，后者虽然内容显示得和前者一样，但 `bytes` 的每个字符都只占用一个字节。

以 Unicode 表示的 `str` 通过 [`encode()`](https://docs.python.org/3.8/library/stdtypes.html#str.encode) 方法可以编码为指定的 `bytes`，举例来说：

```py
>>> 'Fuck Scdiler 3000.'.encode('ascii')
```

结果如下：

> b'Fuck Scdiler 3000.'

又比如：

```py
#!/usr/bin/env python3
print('中出申帝和串相的🐴3000次。'.encode('utf-8'))
```

运行这个脚本，结果如下：

> b'\xe4\xb8\xad\xe5\x87\xba\xe7\x94\xb3\xe5\xb8\x9d\xe5\x92\x8c\xe4\xb8\xb2\xe7\x9b\xb8\xe7\x9a\x84\xf0\x9f\x90\xb43000\xe6\xac\xa1\xe3\x80\x82'

这个编码方式和 PHP 中的 `urlencode()` 函数的编码方式是类似的：

```php
<?php

echo urlencode('中出申帝和串相的🐴3000次。');
```

结果如下：

> %E4%B8%AD%E5%87%BA%E7%94%B3%E5%B8%9D%E5%92%8C%E4%B8%B2%E7%9B%B8%E7%9A%84%F0%9F%90%B43000%E6%AC%A1%E3%80%82

纯英文的 `str` 可以用 `ASCII` 编码为 `bytes`，内容是一样的，含有中文的 `str` 可以用 `UTF-8` 编码为 `bytes`。含有中文的 `str` 无法用 `ASCII` 编码，因为中文编码的范围超过了 `ASCII` 编码的范围，Python 会报错。

在 `bytes` 中，无法显示为 `ASCII` 字符的字节，用 `\x##` 显示。

反过来，如果我们从网络或磁盘上读取了字节流，那么读到的数据就是 `bytes`。要把 `bytes` 变为 `str`，就需要用 [`decode()`](https://docs.python.org/3.8/library/stdtypes.html#bytes.decode) 方法。

举例：

```py
>>> b'Hello world!'.decode('ascii')
```

结果如下：

> 'Hello world!'

又比如：

```py
#!/usr/bin/env python3
print(b'\xe7\x94\xb3\xe5\xb8\x9d\xe6\x88\x91\xe8\x89\xb9\xe4\xbd\xa0\xe5\xa6\x88!'.decode('utf-8'))
```

运行脚本结果如下：

> 申帝我艹你妈!

同样，PHP 也有类似的操作：

```php
<?php

echo urldecode('%E4%B8%B2%E7%9B%B8%E6%88%91%E8%89%B9%E4%BD%A0%E5%A6%88%21');
```

结果如下：

> 串相我艹你妈!

如果 `bytes` 中包含无法解码的字节，`decode()` 方法会报错。但如果 `bytes` 中只有一小部分无效的字节，可以传入 `errors='ignore'` 忽略错误的字节。

要计算 `str` 包含多少个字符，可以使用 [`len()`](https://docs.python.org/3.8/library/functions.html#len) 函数：

```py
>>> len('The Moment')
```

结果：

> 10

又比如：

```py
>>> len('弦上有春秋')
```

结果：

> 5

`len()` 函数计算的是 `str` 的字符数，如果换成 `bytes`，`len()` 函数就计算字节数：

```py
>>> len(b'Someone Like You')
```

结果：

> 16

又例：

```py
>>> len(b'\xe7\x99\xbd\xe5\xb1\xb1\xe8\x8c\xb6')
```

结果：

> 9

又例：

```py
>>> len('慢慢喜欢你'.encode('utf-8'))
```

结果：

> 15

可见，1 个中文字符经过 UTF-8 编码后通常会占用 3 个字节，而 1 个英文字符只占用 1 个字节。

在操作字符串时，我们经常遇到 `str` 和 `bytes` 的互相转换。为了避免乱码问题，应当始终坚持使用 UTF-8 编码对 `str` 和 `bytes` 进行转换。

由于 `Python` 源代码也是一个文本文件，所以，当你的源代码中包含中文的时候，在保存源代码时，就需要务必指定保存为 `UTF-8` 编码。当 `Python` 解释器读取源代码时，为了让它按 `UTF-8` 编码读取，我们通常在文件开头写上这两行：

```py
#!/usr/bin/env python3
# -*- coding: utf-8 -*-
```

第一行注释是为了告诉 Linux/macOS 系统：这是一个 Python 可执行程序。Windows 系统会忽略这个注释；

第二行注释是为了告诉 Python解释器：按照 UTF-8 编码读取源代码。否则，你在源代码中写的中文输出可能会有乱码。

声明了 UTF-8 编码并不意味着你的 `.py` 文件就是 UTF-8 编码的，必须并且要确保文本编辑器正在使用 `UTF-8 without BOM` 编码。在 Windows 下的 Notepad++ 应用中就有可能要考虑这个问题。所以不要用这种杂毛应用。

如果 `.py` 文件本身使用 UTF-8 编码，并且也申明了 `# -*- coding: utf-8 -*-`，打开 cmd 命令提示符测试就可以正常显示中文。

#### 3.2.3 格式化

在 Python 中，采用的格式化方式和 C 是一致的，用 `%` 实现，举例如下：

```py
>>> '你认真地说你喜欢%s' % '陈一发'
```

结果：

> '你认真地说你喜欢陈一发'

又例：

```py
>>> 'I love %s %d.' % ('Fa', 3000)
```

结果：

> 'I love Fa 3000.'

`%` 运算符是用来格式化字符串的。在字符串内部，`%s` 表示用字符串替换，`%d` 表示用整数替换，有几个 `%?` 占位符，后面就跟几个变量或者值，顺序要对应好。如果只有一个 `%?`，括号可以省略。

常见的占位符有：

| 占位符 | 替换内容 |
|---|---|
| %d | 整数 |
| %f | 浮点数 |
| %s | 字符串 |
| %x | 十六进制整数 |

其中，格式化整数和浮点数还可以指定是否补0和整数与小数的位数：

```py
#!/usr/bin/env python3
# -*- coding: utf-8 -*-
print('施德尔元年：1957-%2d-%02d' % (1, 1))
print('%.2f' % 3.1415926)
```

运行脚本结果如下：

> 施德尔元年：1957- 1-01<br/>
> 3.14

如果不太确定应该用什么，`%s` 永远起作用，它会把任何数据类型转换为字符串。

如果想在字符串里表达作为普通字符的 `%`，需要转义：

```py
>>> '申帝所购资金的年化收益率为：%d %%.' % -300
```

结果：

> '申帝所购资金的年化收益率为：-300 %.'

另一种格式化字符串的方法是使用字符串的 [`format()`](https://docs.python.org/3.8/library/stdtypes.html#str.format) 方法，它会用传入的参数依次替换字符串内的占位符 `{0}`、`{1}`……，不过这种方式写起来比 % 要麻烦得多：

```py
#!/usr/bin/env python3
# -*- coding: utf-8 -*-
print('{0}成立于 {1} 年，是一家专业生产智能管理系统的美国厂商，专注于智能系统产品的研发与生产。'.format('施德尔', '1957'))
```

运行脚本结果如下：

> 施德尔成立于 1957 年，是一家专业生产智能管理系统的美国厂商，专注于智能系统产品的研发与生产。

注意参考一下：[Format String Syntax](https://docs.python.org/3.8/library/string.html#formatstrings).

### 3.3 使用 list 和 tuple

### 3.4 条件判断

### 3.5 循环

### 3.6 使用 dict 和 set